import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from matplotlib.dates import DateFormatter


############# Exploite les indices d'incertitude politique de Nick Bloom du 40 ans#############

# Load the Excel file
file_path = 'Donn√©es instab pol/Europe_Policy_Uncertainty_Data (1).xlsx'
data = pd.read_excel(file_path, engine='openpyxl')

print(data.head())
# Drop the last line of the data
data = data[:-1]
# Print the last value of the column "Year"
print("Last year in the data:", data['Year'].iloc[-1])

# Create a new column that indicates the date of each line as the first day of each month
data['Date'] = pd.to_datetime(data[['Year', 'Month']].assign(DAY=1))

# Create subplots
fig, axs = plt.subplots(2, 1, figsize=(10, 12))

# Plot the data for the column "France"
axs[0].plot(data['Date'], data['France_News_Index'], label='France')
axs[0].xaxis.set_major_formatter(DateFormatter('%Y'))
axs[0].xaxis.set_major_locator(plt.MaxNLocator(integer=True, prune='both', nbins=10))
axs[0].set_xlabel('Date')
axs[0].set_ylabel('Policy Uncertainty Index')
axs[0].set_title('Policy Uncertainty Index for France')
axs[0].legend()

# Plot the data for the column "Europe"
axs[1].plot(data['Date'], data['European_News_Index'], label='Europe')
axs[1].xaxis.set_major_formatter(DateFormatter('%Y'))
axs[1].xaxis.set_major_locator(plt.MaxNLocator(integer=True, prune='both', nbins=10))
axs[1].set_xlabel('Date')
axs[1].set_ylabel('Policy Uncertainty Index')
axs[1].set_title('Policy Uncertainty Index for Europe')
axs[1].legend()

# Adjust layout
plt.tight_layout()

plt.show()


